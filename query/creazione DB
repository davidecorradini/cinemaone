CREATE TABLE RUOLO(
ID_RUOLO INT not null primary key GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
RUOLO VARCHAR(50)
);

CREATE TABLE UTENTE(
ID_UTENTE INT not null primary key GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
EMAIL VARCHAR(50),
PASSWORD VARCHAR(50),
CREDITO DOUBLE,
ID_RUOLO INTEGER,
FOREIGN KEY (ID_RUOLO) REFERENCES RUOLO
);

CREATE TABLE PREZZO(
ID_PREZZO INT not null primary key GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
TIPO VARCHAR(50),
PREZZO DOUBLE
);

CREATE TABLE SALA(
ID_SALA INT not null primary key GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
NOME VARCHAR(50),
DESCRIZIONE VARCHAR(50)
);

CREATE TABLE POSTO(
ID_POSTO INT not null primary key GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
ID_SALA INTEGER,
RIGA CHAR(1),
COLONNA INTEGER,
STATO INTEGER,
FOREIGN KEY (ID_SALA) REFERENCES SALA
);

CREATE TABLE GENERE(
ID_GENERE INT not null primary key GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
DESCRIZIONE VARCHAR(50)
);

CREATE TABLE FILM(
ID_FILM INT not null primary key GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
ID_GENERE INTEGER,
TITOLO VARCHAR(100),
DURATA integer,
TRAMA VARCHAR(1000),
URL_TRAILER VARCHAR(255),
URI_LOCANDINA VARCHAR(255),
IS_IN_SLIDER BOOLEAN,
ANNO INT,
REGISTA VARCHAR(255),
FOREIGN KEY (ID_GENERE) REFERENCES GENERE
);

CREATE TABLE SPETTACOLO(
ID_SPETTACOLO INT not null primary key GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
ID_FILM INTEGER,
ID_SALA INTEGER,
DATA_ORA TIMESTAMP,
FOREIGN KEY (ID_FILM) REFERENCES FILM,
FOREIGN KEY (ID_SALA) REFERENCES SALA
);

CREATE TABLE PRENOTAZIONE(
ID_PRENOTAZIONE INT not null primary key GENERATED ALWAYS AS IDENTITY (START WITH 1, INCREMENT BY 1),
ID_UTENTE INTEGER,
ID_SPETTACOLO INTEGER,
ID_PREZZO INTEGER,
ID_POSTO INTEGER,
DATA_ORA_OPERAZIONE TIMESTAMP,
FOREIGN KEY (ID_UTENTE) REFERENCES UTENTE,
FOREIGN KEY (ID_SPETTACOLO) REFERENCES SPETTACOLO,
FOREIGN KEY (ID_PREZZO) REFERENCES PREZZO,
FOREIGN KEY (ID_POSTO) REFERENCES POSTO
);

CREATE TABLE PRENOTAZIONETmp(
ID_UTENTE CHAR(32),
ID_SPETTACOLO INTEGER,
ID_POSTO INTEGER,
DATA_ORA_OPERAZIONETmp TIMESTAMP,
PRIMARY KEY (ID_SPETTACOLO, ID_POSTO),
FOREIGN KEY (ID_SPETTACOLO) REFERENCES SPETTACOLO,
FOREIGN KEY (ID_POSTO) REFERENCES POSTO
);

CREATE TABLE CONTATTITELEFONICI(
NOME VARCHAR(100),
NUMEROTELEFONICO BIGINT
);

CREATE TABLE PASSWORDRECOVERY(
MD5 CHAR(32),
EMAIL VARCHAR(50),
TIME TIMESTAMP
);